<div *ngIf="currentGuild$() as guild" class="p-4">

  <app-guild-table [currentUser]="currentUser$()!" [guild]="guild"/>

  <mat-card class="overflow-hidden shadow-lg rounded-lg mt-6">
    <mat-card-header class="bg-primary-600 text-white">
      <mat-card-subtitle>Demandes d'adh√©sion</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content class="p-0">
      <table [dataSource]="guild.membershipRequests" class="min-w-full divide-y divide-gray-300" mat-table>
        <ng-container matColumnDef="username">
          <th *matHeaderCellDef class="p-3 text-left text-sm font-semibold text-gray-700" mat-header-cell>Nom</th>
          <td *matCellDef="let request" class="p-3 text-sm text-gray-700 whitespace-nowrap"
              mat-cell>{{ request.user.username }}</td>
        </ng-container>
        <ng-container matColumnDef="characterClass">
          <th *matHeaderCellDef class="p-3 text-left text-sm font-semibold text-gray-700" mat-header-cell>Classe</th>
          <td *matCellDef="let request" class="p-3 text-sm text-gray-700 whitespace-nowrap"
              mat-cell>
            <div class="flex flex-row items-center space-x-2">
              <img [src]="request.user | characterIcon" alt="Character Icon" height="20" width="20">
              <div>{{ request.user.characterClass }}</div>
            </div>
          </td>
        </ng-container>
        <ng-container matColumnDef="characterLevel">
          <th *matHeaderCellDef class="p-3 text-left text-sm font-semibold text-gray-700" mat-header-cell>Level</th>
          <td *matCellDef="let request" class="p-3 text-sm text-gray-700 whitespace-nowrap"
              mat-cell>{{ request.user.characterLevel }}</td>
        </ng-container>
        <ng-container matColumnDef="actions">
          <th *matHeaderCellDef class="p-3 text-left text-sm font-semibold text-gray-700" mat-header-cell>Actions</th>
          <td *matCellDef="let request" class="p-3 flex justify-start space-x-2">
            <button (click)="acceptRequest(request.id)" color="primary" mat-flat-button>Accepter</button>
            <button (click)="declineRequest(request.id)" color="warn" mat-button>Refuser</button>
          </td>
        </ng-container>
        <tr *matHeaderRowDef="['username', 'characterClass', 'characterLevel', 'actions']" class="bg-gray-100"
            mat-header-row></tr>
        <tr *matRowDef="let row; columns: ['username', 'characterClass', 'characterLevel','actions'];" mat-row></tr>
      </table>
    </mat-card-content>
  </mat-card>
</div>
